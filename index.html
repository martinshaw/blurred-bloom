<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bloom</title>

    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
        }

        .background > svg {
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>

    <script>
        const convertPercentageStringToFloat = (percentageString) => {
            return parseFloat(percentageString.replace('%', '')) / 100;
        };

        const convertFloatToPercentageString = (float) => {
            return `${float * 100}%`;
        };

        class Circle {
            constructor(cx, cy, r, fill) {
                this.cx = cx;
                this.cy = cy;
                this.r = r;
                this.fill = fill;
                
                // this.directionX = (Math.random() * 2 - 1);
                // this.directionY = (Math.random() * 2 - 1);
                // this.directionR = (Math.random() * 2 - 1);

                this.directionX = 0.003;
                this.directionY = 0.003;
                this.directionR = 1;
            }

            move() {
                this.cx = convertFloatToPercentageString(convertPercentageStringToFloat(this.cx) + this.directionX);
                this.cy = convertFloatToPercentageString(convertPercentageStringToFloat(this.cy) + this.directionY);
                this.r += this.directionR;

                if (convertPercentageStringToFloat(this.cx) < 0 || convertPercentageStringToFloat(this.cx) > 1) this.directionX *= -1;
                if (convertPercentageStringToFloat(this.cy) < 0 || convertPercentageStringToFloat(this.cy) > 1) this.directionY *= -1;
                if (this.r < (defaultCircleWidth * .8) || this.r > (defaultCircleWidth * 1.3)) this.directionR *= -1;
            }

            render() {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', this.cx);
                circle.setAttribute('cy', this.cy);
                circle.setAttribute('r', this.r);
                circle.setAttribute('fill', this.fill);

                return circle;
            }
        }

        const defaultCircleWidth = 150

        let circles = [
            new Circle('33.3333%', '10%', defaultCircleWidth, 'red'),
            new Circle('66.6666%', '10%', defaultCircleWidth, 'green'),
            new Circle('99.9999%', '10%', defaultCircleWidth, 'blue')
        ];

        // on document load
        document.addEventListener('DOMContentLoaded', () => {
            // get the svg element
            const svg = document.querySelector('svg');

            // get the filter
            const filter = document.querySelector('filter');

            // use it to animate the circles
            setInterval(() => {
                // Remove all circle elements from the svg
                svg.querySelectorAll('circle').forEach(circle => {
                    circle.remove();
                });

                // iterate over the circles
                circles.forEach(circle => {
                    // move the circle
                    circle.move();

                    // render the circle
                    svg.appendChild(circle.render());
                });
            }, 1000/100);
        });
    </script>
</head>
<body>
    <div class="background">
        <!-- Create an SVG which fits the full viewport dimensions. It should contain three large circles, distributed horizontally across the svg. These circles should be blurred -->
        <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" filter="url(#blur)">
            <filter id="blur">
                <feGaussianBlur in="SourceGraphic"  stdDeviation="99" />
            </filter>
        </svg>
    </div>
</body>
</html>